<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Язык R в интернет маркетинге" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Методичесткое пособие к авторскому курсу Алексея Селезнёва “Язык R в интернет маркетинге.”" />
<meta name="github-repo" content="rstudio/bookdown-demo" />

<meta name="author" content="Алексей Селезнёв" />

<meta name="date" content="2018-10-03" />


<meta name="description" content="Методичесткое пособие к авторскому курсу Алексея Селезнёва “Язык R в интернет маркетинге.”">

<title>Язык R в интернет маркетинге</title>

<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#section-1"><span class="toc-section-number">1</span> Описание</a></li>
<li class="has-sub"><a href="2-a-.html#a----"><span class="toc-section-number">2</span> a - О курсе</a><ul>
<li><a href="2-1-.html#---"><span class="toc-section-number">2.1</span> Для кого этот курс</a></li>
<li><a href="2-2-.html#-----"><span class="toc-section-number">2.2</span> Какие знания требуются для прохождения курса</a></li>
<li><a href="2-3-.html#-------"><span class="toc-section-number">2.3</span> Какие темы не будут затронуты в ходе курса</a></li>
<li><a href="2-4-.html#------"><span class="toc-section-number">2.4</span> Что вы будете уметь поосле проождения курса</a></li>
<li><a href="2-5-.html#-"><span class="toc-section-number">2.5</span> Поддержка студентов</a></li>
<li><a href="2-5-.html#-"><span class="toc-section-number">2.6</span> Конспект курса</a></li>
<li><a href="2-5-.html#-"><span class="toc-section-number">2.7</span> Программа курса</a></li>
</ul></li>
<li><a href="3-b-.html#b----"><span class="toc-section-number">3</span> b - Об авторе</a></li>
<li><a href="4-c-.html#c---"><span class="toc-section-number">4</span> c - Благодарности</a></li>
<li class="has-sub"><a href="5-1-r-.html#-1---r."><span class="toc-section-number">5</span> Модуль 1: Введение в R.</a><ul>
<li><a href="5-1-r.html#---r"><span class="toc-section-number">5.1</span> История создания языка R</a></li>
<li><a href="5-2-r-.html#--r."><span class="toc-section-number">5.2</span> Преимущества языка R.</a></li>
<li class="has-sub"><a href="5-3-r-rstudio.html#--r----rstudio"><span class="toc-section-number">5.3</span> Установка языка R и среды разработки RStudio</a><ul>
<li><a href="5-3-r-rstudio.html#---r--rstudio"><span class="toc-section-number">5.3.1</span> Ссылки для загрузки R и RStudio</a></li>
</ul></li>
<li class="has-sub"><a href="5-4-power-bi-r-.html#------power-bi---r-."><span class="toc-section-number">5.4</span> Загрузка, преобразование и визуализация данных в Power BI с помощью R скриптов.</a><ul>
<li><a href="5-4-power-bi-r-.html#---power-bi."><span class="toc-section-number">5.4.1</span> Загрузка данных в Power BI.</a></li>
<li><a href="5-4-power-bi-r-.html#---power-bi-power-query."><span class="toc-section-number">5.4.2</span> Преобразование данных в Power BI (power query).</a></li>
<li><a href="5-4-power-bi-r-.html#---power-bi------r."><span class="toc-section-number">5.4.3</span> Визуализация данных в Power BI с помощью визуального элемента скрипта R.</a></li>
<li><a href="5-4-power-bi-r-.html#---power-bi--r-."><span class="toc-section-number">5.4.4</span> Использование пользовательских параметров Power BI в R скриптах.</a></li>
</ul></li>
<li><a href="5-5-rstudio.html#--rstudio"><span class="toc-section-number">5.5</span> Среда разработки RStudio</a></li>
<li class="has-sub"><a href="5-6-r.html#----r"><span class="toc-section-number">5.6</span> Классы объектов в языке R</a><ul>
<li><a href="5-6-r.html#section-5.6.1"><span class="toc-section-number">5.6.1</span> Векторы</a></li>
<li><a href="5-6-r.html#-data.frame"><span class="toc-section-number">5.6.2</span> Таблицы (data.frame)</a></li>
<li><a href="5-6-r.html#-list"><span class="toc-section-number">5.6.3</span> Списки (list)</a></li>
<li><a href="5-6-r.html#--"><span class="toc-section-number">5.6.4</span> Проверить класс объекта</a></li>
</ul></li>
<li class="has-sub"><a href="5-7-r.html#-----r"><span class="toc-section-number">5.7</span> Работа со строками на языке R</a><ul>
<li><a href="5-7-r.html#-------r"><span class="toc-section-number">5.7.1</span> Базовые возможности для работы со строками в R</a></li>
<li><a href="5-7-r.html#------stringr"><span class="toc-section-number">5.7.2</span> Работа со строками с помощью пакета stringr</a></li>
</ul></li>
<li class="has-sub"><a href="5-8-csv-excel-json-r.html#---csv-excel--json---r"><span class="toc-section-number">5.8</span> Загрузка данных из csv, excel и json файлов в R</a><ul>
<li><a href="5-8-csv-excel-json-r.html#---csv-"><span class="toc-section-number">5.8.1</span> Загрузка данных из csv файлов</a></li>
<li><a href="5-8-csv-excel-json-r.html#---excel-"><span class="toc-section-number">5.8.2</span> Загрузка данных из Excel файлов</a></li>
<li><a href="5-8-csv-excel-json-r.html#---json-"><span class="toc-section-number">5.8.3</span> Загрузка данных из JSON файлов</a></li>
</ul></li>
<li><a href="5-9-r.html#------r"><span class="toc-section-number">5.9</span> Агрегирующие функции и арифметические операции в R</a></li>
<li class="has-sub"><a href="5-10-.html#-----."><span class="toc-section-number">5.10</span> Манипуляция с данными, (группировка и агреция).</a><ul>
<li><a href="5-10-.html#-dplyr"><span class="toc-section-number">5.10.1</span> Пакет dplyr</a></li>
<li><a href="5-10-.html#-data.table"><span class="toc-section-number">5.10.2</span> Пакет data.table</a></li>
<li><a href="5-10-.html#-sqldf"><span class="toc-section-number">5.10.3</span> Пакет sqldf</a></li>
<li><a href="5-10-.html#-tidyr"><span class="toc-section-number">5.10.4</span> Пакет tidyr</a></li>
</ul></li>
<li class="has-sub"><a href="5-11-r-lubridate-.html#------r--lubridate."><span class="toc-section-number">5.11</span> Работа с датами и временем в R, пакет lubridate.</a><ul>
<li><a href="5-11-r-lubridate-.html#---------r"><span class="toc-section-number">5.11.1</span> Базовые возможности по работе с датой и временем в R</a></li>
<li><a href="5-11-r-lubridate-.html#-lubridate"><span class="toc-section-number">5.11.2</span> Пакет lubridate</a></li>
</ul></li>
<li><a href="5-12-if-ifelse-switch-r.html#--if-ifelse-switch--r"><span class="toc-section-number">5.12</span> Условные конструкции if, ifelse, switch в R</a></li>
<li class="has-sub"><a href="5-13-for-while.html#-for--while"><span class="toc-section-number">5.13</span> Циклы for и while</a><ul>
<li><a href="5-13-for-while.html#-for"><span class="toc-section-number">5.13.1</span> Цикл for</a></li>
<li><a href="5-13-for-while.html#-while"><span class="toc-section-number">5.13.2</span> Цикл while</a></li>
</ul></li>
<li><a href="5-7-r.html#-----r"><span class="toc-section-number">5.14</span> Разработка собственных функций в языке R</a></li>
<li><a href="5-15-r-try.html#---r--try"><span class="toc-section-number">5.15</span> Обработка ошибок в R, функция try</a></li>
<li><a href="2-1-.html#---"><span class="toc-section-number">5.16</span> Рекомендации по оформлению кода</a></li>
</ul></li>
<li class="has-sub"><a href="6-2-api-.html#-2---api--."><span class="toc-section-number">6</span> Модуль 2: Работа с API рекламных площадок.</a><ul>
<li class="has-sub"><a href="6-1-api.html#--api"><span class="toc-section-number">6.1</span> Что такое API</a><ul>
<li><a href="6-1-api.html#-http-"><span class="toc-section-number">6.1.1</span> Типы HTTP запросов</a></li>
</ul></li>
<li class="has-sub"><a href="6-2-api-google-ads.html#--api-google-ads"><span class="toc-section-number">6.2</span> Работа с API Google Ads</a><ul>
<li><a href="6-2-api-google-ads.html#----api-google-ads"><span class="toc-section-number">6.2.1</span> Как получить доступ к API Google Ads</a></li>
<li><a href="6-2-api-google-ads.html#--api-google-ads"><span class="toc-section-number">6.2.2</span> Как устроен API Google Ads</a></li>
<li><a href="6-2-api-google-ads.html#-radwords"><span class="toc-section-number">6.2.3</span> Пакет RAdwords</a></li>
</ul></li>
<li class="has-sub"><a href="6-3-api-.html#--api--"><span class="toc-section-number">6.3</span> Работа с API Яндекс Директ</a><ul>
<li><a href="6-3-api-.html#-ryandexdirect"><span class="toc-section-number">6.3.1</span> Пакет ryandexdirect</a></li>
</ul></li>
<li class="has-sub"><a href="6-4-api-facebook.html#--api-facebook"><span class="toc-section-number">6.4</span> Работа с API Facebook</a><ul>
<li><a href="6-4-api-facebook.html#---facebook"><span class="toc-section-number">6.4.1</span> Создание приложения в Facebook</a></li>
<li><a href="6-4-api-facebook.html#--api-facebook"><span class="toc-section-number">6.4.2</span> Авторизация в API Facebook</a></li>
<li><a href="6-4-api-facebook.html#-----facebook"><span class="toc-section-number">6.4.3</span> Загрузка объектов из рекламного кабинета Facebook</a></li>
</ul></li>
<li class="has-sub"><a href="6-5-api-vk-com.html#--api--vk.com"><span class="toc-section-number">6.5</span> Работа с API Вконтакте (vk.com)</a><ul>
<li><a href="6-5-api-vk-com.html#-----api-"><span class="toc-section-number">6.5.1</span> Создание приложения для работы с API Вконтакте</a></li>
<li><a href="6-5-api-vk-com.html#--api-"><span class="toc-section-number">6.5.2</span> Авторизация в API Вконтакте</a></li>
<li><a href="6-5-api-vk-com.html#--rvkstat"><span class="toc-section-number">6.5.3</span> Функции пакета rvkstat</a></li>
<li><a href="2-2-.html#-----"><span class="toc-section-number">6.5.4</span> Загрузка объектов из рекламного кабинета Вконтакте</a></li>
<li><a href="2-2-.html#-----"><span class="toc-section-number">6.5.5</span> Загрузка статистики из рекламного кабинета Вконтакте</a></li>
<li><a href="2-4-.html#------"><span class="toc-section-number">6.5.6</span> Загрузка статистики по сообществам и группам Вконтакте</a></li>
</ul></li>
<li class="has-sub"><a href="6-6-api-mytarget.html#--api-mytarget"><span class="toc-section-number">6.6</span> Работа с API MyTarget</a><ul>
<li><a href="6-6-api-mytarget.html#--api-mytarget"><span class="toc-section-number">6.6.1</span> Авторизация в API MyTarget</a></li>
</ul></li>
<li class="has-sub"><a href="6-7-google-analytics.html#---google-analytics"><span class="toc-section-number">6.7</span> Загрузка данных из Google Analytics</a><ul>
<li><a href="6-7-google-analytics.html#-api----google-analytics"><span class="toc-section-number">6.7.1</span> Какие API интерфейсы доступны в Google Analytics</a></li>
<li><a href="6-7-google-analytics.html#--api-google-analytics"><span class="toc-section-number">6.7.2</span> Авторизация в API Google Analytics</a></li>
<li><a href="6-7-google-analytics.html#--management-api"><span class="toc-section-number">6.7.3</span> Работа с Management API</a></li>
<li><a href="6-7-google-analytics.html#--core-reporting-api"><span class="toc-section-number">6.7.4</span> Работа с Core Reporting API</a></li>
<li><a href="6-7-google-analytics.html#--multi-channel-funnels-api"><span class="toc-section-number">6.7.5</span> Работа с Multi-Channel Funnels API</a></li>
<li><a href="6-7-google-analytics.html#--real-time-reporting-api"><span class="toc-section-number">6.7.6</span> Работа с Real time reporting API</a></li>
</ul></li>
<li class="has-sub"><a href="6-3-api-.html#---api--"><span class="toc-section-number">6.8</span> Загрузка данных из API Яндекс Метрики</a><ul>
<li><a href="6-3-api-.html#----api--"><span class="toc-section-number">6.8.1</span> Авторизация для работы с API Яндекс Метрики</a></li>
<li><a href="6-8-api-.html#----api---"><span class="toc-section-number">6.8.2</span> Функции для работы с API управления Яндекс Метрики</a></li>
<li><a href="6-8-api-.html#---api---"><span class="toc-section-number">6.8.3</span> Загрузка данных из API отчётов Яндекс Метрики</a></li>
<li><a href="6-8-api-.html#---logs-api--"><span class="toc-section-number">6.8.4</span> Загрузка данных из Logs API Яндекс Метрики</a></li>
<li><a href="6-8-api-.html#---api-----core-reporting-api-google-analytics"><span class="toc-section-number">6.8.5</span> Загрузка данных из API Яндекс Метрики совместимого с Core Reporting API Google Analytics</a></li>
</ul></li>
<li class="has-sub"><a href="6-9-google-search-console.html#--google-search-console"><span class="toc-section-number">6.9</span> Работа с Google Search Console</a><ul>
<li><a href="6-9-google-search-console.html#----5000---1-"><span class="toc-section-number">6.9.1</span> Как обойти ограничение в 5000 строк на 1 запрос</a></li>
</ul></li>
<li class="has-sub"><a href="6-10-google-trends.html#--google-trends"><span class="toc-section-number">6.10</span> Работа с Google Trends</a><ul>
<li><a href="6-10-google-trends.html#-----google-trends"><span class="toc-section-number">6.10.1</span> Манипуляция с данными полученными из Google Trends</a></li>
</ul></li>
<li class="has-sub"><a href="5-6-r.html#--"><span class="toc-section-number">6.11</span> Парсинг веб сайтов</a><ul>
<li><a href="5-6-r.html#----"><span class="toc-section-number">6.11.1</span> Поиск элементов на веб странице</a></li>
<li><a href="6-11-.html#-----html-"><span class="toc-section-number">6.11.2</span> Извлечение значений из полученныз элементов HTML страницы</a></li>
<li><a href="2-1-.html#---"><span class="toc-section-number">6.11.3</span> Имитация пользовательской веб сессии</a></li>
</ul></li>
<li><a href="6-1-api.html#-http-"><span class="toc-section-number">6.12</span> отправка HTTP запросов</a></li>
</ul></li>
<li class="has-sub"><a href="7-3-api-.html#-3-----api----."><span class="toc-section-number">7</span> Модуль 3: Работа с загруженными из API интерфейсов различных сервисов данными.</a><ul>
<li><a href="7-1-google-.html#-----google-"><span class="toc-section-number">7.1</span> Отправка и стение данных из Google Таблиц</a></li>
<li class="has-sub"><a href="7-2-ggplot2.html#-----ggplot2"><span class="toc-section-number">7.2</span> Визуализация данных с помощью пакета ggplot2</a><ul>
<li><a href="7-2-ggplot2.html#---qplot"><span class="toc-section-number">7.2.1</span> Быстрый график, функция <code>qplot</code></a></li>
<li><a href="2-1-.html#---"><span class="toc-section-number">7.2.2</span> Построение графиков наложением слоёв</a></li>
</ul></li>
<li class="has-sub"><a href="7-3-dbi-.html#----dbi-------"><span class="toc-section-number">7.3</span> Работа с базами данных, DBI - Интерфейс взаимодействия с базами данных</a><ul>
<li><a href="7-3-dbi-.html#---mysql"><span class="toc-section-number">7.3.1</span> Работа с СУБД MySQL</a></li>
<li><a href="7-3-dbi-.html#----postgresql"><span class="toc-section-number">7.3.2</span> Работа с базой данных PostgreSQL</a></li>
<li><a href="7-3-dbi-.html#----sqlite"><span class="toc-section-number">7.3.3</span> Работа с базой данных SQLite</a></li>
<li><a href="7-3-dbi-.html#-----google-bigquery"><span class="toc-section-number">7.3.4</span> Работа с облачной базой данных Google BigQuery</a></li>
</ul></li>
<li><a href="5-6-r.html#----r"><span class="toc-section-number">7.4</span> Отправка почты с помощью R</a></li>
<li class="has-sub"><a href="7-5-r-.html#---r---"><span class="toc-section-number">7.5</span> Как настроить запуск R скриптов по рассписанию</a><ul>
<li><a href="2-1-.html#---"><span class="toc-section-number">7.5.1</span> Настройка расписание через плагин</a></li>
<li><a href="7-5-r-.html#------taskscheduler"><span class="toc-section-number">7.5.2</span> Настройка расписание с помощью функций пакета taskscheduleR</a></li>
<li><a href="7-5-r-.html#------windows"><span class="toc-section-number">7.5.3</span> Ручная настройка рассписания через планировщик задач Windows</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="8-r-r-sources.html#-----r-r-sources"><span class="toc-section-number">8</span> Полезные, русскоязычные ресурсы по языку R (r sources)</a><ul>
<li><a href="2-1-.html#---"><span class="toc-section-number">8.1</span> Группы в социальных сетях</a></li>
<li><a href="2-1-.html#---"><span class="toc-section-number">8.2</span> Телеграмм каналы и чаты</a></li>
<li><a href="8-3-section-8-3.html#section-8.3"><span class="toc-section-number">8.3</span> Блоги</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="--api--" class="section level2">
<h2><span class="header-section-number">6.3</span> Работа с API Яндекс Директ</h2>
<p>Для работы с API Яндекс Директ в R есть пакет ryandexdirect, его функции позволяют вам выполнять следующие действия:</p>
<ol style="list-style-type: decimal">
<li>Авторизовываться в API.</li>
<li>Получать список различных объектов рекламного кабинета, рекламных кампаний, групп объявлений, объявлений, для агентских аккаунтов можно запрашивать список клиентов, и параметры каждого клиента.</li>
<li>Управлять показами на уровне рекламных кампаний, групп объявлений и объявлений.</li>
<li>Загружать статистику.</li>
<li>Загружать справочную информацию.</li>
</ol>
<p>Для автоизации в API можно использовать функцию <code>yadirAuth</code>, но делать это необязательно т.к. при вызове любой из функций пакета изначально R ищет файл в котором хранятся учётные данные, и если не находит то вы автоматически переходите в браузер для прохождения процесса авторизации.</p>
<div id="-ryandexdirect" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Пакет ryandexdirect</h3>
<p>Устанавливать пакет <code>ryandexdirect</code> рекомендую из моего репозитория на GitHub с помощью команды <code>devtools::install_github('selesnow/ryandexdirect')</code>.</p>
<p>Для прохождения процесса авторизации в ryandexdirect существует функция <code>yadirAuth</code>, но отдельно вызывать её нет необходимости, т.к. при запуске любой из функций пакета, изначально запускается процесс поиска файла хранящего учётные данные, если такой файл функция не находит то автоматически запускается процесс авторизации.</p>
<p>Все функции пакета содержат набор аргументов для работы с учётными данными: * Login - Логин на яндексе клиентского аккаунта, используется для авторизации под обычным, клиентским аккаунтом, а так же в названии файла в котором хранятся учётные данные. * AgencyAccount - Логин на яндексе для управляющего, агентского аккаунта, используется для авторизации под агентским аккаунтом, а так же в названии файла в котором хранятся учётные данные. * TokenPath - Путь к папке в которой вы храните файлы с учётными данными, при первом обращении к API из под какого либо аккаунта файл сохраняется в указанной папке, далее при работе с этим аккаунтом, функции пакета ищут его в указанной папке по аккаунту указанному в аргементе Login или AgencyAccount. * Token - <strong>Устаревший аргумент</strong>, не рекомендуемый к использованию, принимает токен доступа к API в виде строки, сохранён для воспроизведения кода написаного до версии 3.0.0.</p>
<div id="---api--" class="section level4">
<h4><span class="header-section-number">6.3.1.1</span> Загрузка объектов из API Яндекс Директ</h4>
<p>Для загрузки различных объектов из рекламного кабинета Яндекс Директ в пакете <em>ryandecdirect</em> есть одноимённые функции:</p>
<ul>
<li><code>yadirGetCampaignList</code> - Загрузка списка рекламных кампаний</li>
<li><code>yadirGetAdGroups</code> - Загрузка списка групп объявлений</li>
<li><code>yadirGetKeyWords</code> - Загрузка списка ключевых слов</li>
<li><code>yadirGetSiteLinks</code> - Загрузка списка быстрых ссылок</li>
<li><code>yadirGetBalance</code> - Загрузка параметров общего счёта</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ryandexdirect)
<span class="kw">setwd</span>(<span class="st">&quot;C:</span><span class="ch">\\</span><span class="st">r_for_marketing_course</span><span class="ch">\\</span><span class="st">Материалы курса</span><span class="ch">\\</span><span class="st">Модуль 2</span><span class="ch">\\</span><span class="st">Урок 3&quot;</span>)

<span class="co"># Запрос объектов рекламного аккаунта</span>
<span class="co"># Список рекламных кампаний</span>
my_camp   &lt;-<span class="st"> </span><span class="kw">yadirGetCampaignList</span>(<span class="dt">Logins    =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                                  <span class="dt">TokenPath =</span> <span class="st">&quot;direct_tokens&quot;</span>)
<span class="co"># Список групп объявлений</span>
my_group  &lt;-<span class="st"> </span><span class="kw">yadirGetAdGroups</span>(<span class="dt">Login     =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                              <span class="dt">TokenPath =</span> <span class="st">&quot;direct_tokens&quot;</span>)

<span class="co"># Список ключевых слов</span>
my_keyw   &lt;-<span class="st"> </span><span class="kw">yadirGetKeyWords</span>(<span class="dt">Login     =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                              <span class="dt">States    =</span> <span class="st">&quot;ON&quot;</span>,
                              <span class="dt">TokenPath =</span> <span class="st">&quot;direct_tokens&quot;</span>)

<span class="co"># Список быстрых ссылок</span>
my_links  &lt;-<span class="st"> </span><span class="kw">yadirGetSiteLinks</span>(<span class="dt">Login     =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                               <span class="dt">TokenPath =</span> <span class="st">&quot;direct_tokens&quot;</span>)

<span class="co"># Загрузка данных по общему счёту, ключая остаток</span>
balance       &lt;-<span class="st"> </span><span class="kw">yadirGetBalance</span>(<span class="dt">Login     =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                                 <span class="dt">TokenPath =</span> <span class="st">&quot;direct_tokens&quot;</span>)</code></pre></div>
</div>
<div id="----api--" class="section level4">
<h4><span class="header-section-number">6.3.1.2</span> Загрузка справочной информации из API Яндекс Директ</h4>
<p>Для загрузки справочной информации из API Яндекс Директ необхоимо использовать функцию <code>yadirGetDictionary</code>, передав в аргумент <em>DictionaryName</em> название справочника который хотите получить.</p>
<ul>
<li>Currencies - Курсы валют, валютные параметры и ограничения.</li>
<li>MetroStations - Станции метрополитена (только для Москвы, Санкт-Петербурга и Киева).</li>
<li>GeoRegions - Регионы.</li>
<li>TimeZones - Часовые пояса.</li>
<li>Constants - Ограничения на значения параметров.</li>
<li>AdCategories - Особые категории рекламируемых товаров и услуг.</li>
<li>OperationSystemVersions - Версии операционных систем для рекламы мобильных приложений.</li>
<li>ProductivityAssertions - Параметр утратил актуальность и не возвращается.</li>
<li>SupplySidePlatforms - Внешние сети (SSP).</li>
<li>Interests - Интересы к категориям мобильных приложений.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geo      &lt;-<span class="st"> </span><span class="kw">yadirGetDictionary</span>(<span class="dt">DictionaryName =</span> <span class="st">&quot;GeoRegions&quot;</span>,
                               <span class="dt">Login          =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                               <span class="dt">TokenPath      =</span> <span class="st">&quot;direct_tokens&quot;</span>)

cur      &lt;-<span class="st"> </span><span class="kw">yadirGetDictionary</span>(<span class="dt">DictionaryName =</span> <span class="st">&quot;Currencies&quot;</span>,
                               <span class="dt">Login          =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                               <span class="dt">TokenPath      =</span> <span class="st">&quot;direct_tokens&quot;</span>)

adcategories &lt;-<span class="st"> </span><span class="kw">yadirGetDictionary</span>(<span class="dt">DictionaryName =</span> <span class="st">&quot;AdCategories&quot;</span>,
                                   <span class="dt">Login          =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                                   <span class="dt">TokenPath      =</span> <span class="st">&quot;direct_tokens&quot;</span>)

constant     &lt;-<span class="st"> </span><span class="kw">yadirGetDictionary</span>(<span class="dt">DictionaryName =</span> <span class="st">&quot;Constants&quot;</span>,
                                   <span class="dt">Login          =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                                   <span class="dt">TokenPath      =</span> <span class="st">&quot;direct_tokens&quot;</span>)</code></pre></div>
</div>
<div id="-" class="section level4">
<h4><span class="header-section-number">6.3.1.3</span> Управление показами</h4>
<p>Помимо загрузки различных объектов из рекламного кабинета с помощью <code>ryandexdirect</code> вы можете останавливать и возобновлять показы на уровне рекламных кампаний, ключевых слов и объявлений.</p>
<p>Для остановки показов необходимо воспользоваться одной из функций: * yadirStopCampaigns - Остановка показов на уровне рекламных кампаний * yadirStopKeyWords - Остановка показов на уровне ключевых слов * yadirStopAds - Остановка показов на уровне объявлений</p>
<p>Возобновление показов осуществляется с помощью группы функций <code>yadirStart</code>: * yadirStartCampaigns - Возобновление показов на уровне рекламных кампаний * yadirStartKeyWords - Возобновление показов на уровне ключевых слов * yadirStartAds - Возобновление показов на уровне объявлений</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Список рекламных кампаний</span>
my_camp   &lt;-<span class="st"> </span><span class="kw">yadirGetCampaignList</span>(<span class="dt">Logins    =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                                  <span class="dt">TokenPath =</span> <span class="st">&quot;direct_tokens&quot;</span>)

<span class="co"># Запуск и остановка показов</span>
<span class="co"># получаем список активных РК</span>
active_campaign_before &lt;-<span class="st"> </span>my_camp<span class="op">$</span>Id[my_camp<span class="op">$</span>State <span class="op">==</span><span class="st"> &quot;ON&quot;</span>]
<span class="co"># остановка рекламных кампаний</span>
<span class="kw">yadirStopCampaigns</span>(<span class="dt">Ids =</span> <span class="kw">c</span>(<span class="dv">30361157</span>, <span class="dv">30361191</span>),
                   <span class="dt">Login          =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                   <span class="dt">TokenPath      =</span> <span class="st">&quot;direct_tokens&quot;</span>)

<span class="co"># получаем список активных РК</span>
my_camp_new &lt;-<span class="st"> </span><span class="kw">yadirGetCampaignList</span>(<span class="dt">Logins    =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                                    <span class="dt">TokenPath =</span> <span class="st">&quot;direct_tokens&quot;</span>)

active_campaign_after_stoped &lt;-<span class="st"> </span>my_camp_new<span class="op">$</span>Id[my_camp_new<span class="op">$</span>State <span class="op">==</span><span class="st"> &quot;ON&quot;</span>]

<span class="co"># запускаем РК</span>
<span class="kw">yadirStartCampaigns</span>(<span class="dt">Ids =</span> <span class="kw">c</span>(<span class="dv">30361157</span>, <span class="dv">30361191</span>),
                    <span class="dt">Login          =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                    <span class="dt">TokenPath      =</span> <span class="st">&quot;direct_tokens&quot;</span>)
<span class="co"># получаем список активных РК</span>
my_camp_new2 &lt;-<span class="st"> </span><span class="kw">yadirGetCampaignList</span>(<span class="dt">Logins    =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                                     <span class="dt">TokenPath =</span> <span class="st">&quot;direct_tokens&quot;</span>)

active_campaign_after_start &lt;-<span class="st"> </span>my_camp_new<span class="op">$</span>Id[my_camp_new2<span class="op">$</span>State <span class="op">==</span><span class="st"> &quot;ON&quot;</span>]

<span class="co"># сверяем со списком который был до остановки</span>
<span class="kw">all.equal</span>(active_campaign_before, active_campaign_after_start)</code></pre></div>
<p>В аргумент <em>Id</em> необходимо передавать вектор Id тех объектов по которым вы хотите запустить или остановить показы.</p>
</div>
<div id="---api--" class="section level4">
<h4><span class="header-section-number">6.3.1.4</span> Загрузка статистики из API Яндекс Директ</h4>
<p>API интерфейс Reports в Яндекс Директ похож на Google Ads, так же состоит из отчётов и полей. На момент последнего редактирования данного конспекта в API ЯНдекс Директ существует 8 отчётов.</p>
<ol style="list-style-type: decimal">
<li>ACCOUNT_PERFORMANCE_REPORT - Статистика по аккаунту рекламодателя</li>
<li>CAMPAIGN_PERFORMANCE_REPORT - Статистика по кампаниям</li>
<li>ADGROUP_PERFORMANCE_REPORT - Статистика по группам объявлений</li>
<li>AD_PERFORMANCE_REPORT - Статистика по объявлениям</li>
<li>CRITERIA_PERFORMANCE_REPORT - Статистика по условиям показа</li>
<li>CUSTOM_REPORT - Статистика с произвольными группировками</li>
<li>REACH_AND_FREQUENCY_PERFORMANCE_REPORT - Статистика по медийным кампаниям. Отчет содержит только данные по кампаниям с типом «Медийная кампания», кампании остальных типов игнорируются</li>
<li>SEARCH_QUERY_PERFORMANCE_REPORT - Статистика по поисковым запросам</li>
</ol>
<p>Актуальный список отчётов можно найти по <a href="https://tech.yandex.ru/direct/doc/reports/type-docpage/">ссылке</a>, список полей можно найти <a href="https://tech.yandex.ru/direct/doc/reports/fields-list-docpage/">тут</a>.</p>
<p>Все поля поделены на 4 группы:</p>
<ul>
<li><p>фильтр — поле используется только для фильтрации данных и не может быть выведено в отчете;</p></li>
<li><p>сегмент — при выводе в отчете поле используется для группировки данных;</p></li>
<li><p>метрика — поле содержит числовое значение, рассчитанное в соответствии с заданными фильтрами и группировками;</p></li>
<li><p>атрибут — поле содержит фиксированное значение в соответствии с заданными группировками, добавление такого поля в отчет не приводит к появлению новой группировки.</p></li>
</ul>
<p>Загрузка статистики осуществляется с помощью функции <code>yadirGetReport</code>, которая принимает следующие аргументы.</p>
<ul>
<li>ReportType - Тип отчёта</li>
<li>DateRangeType - Отчётный период, принимает следующие значения (TODAY, YESTERDAY, LAST_3_DAYS, LAST_5_DAYS, LAST_7_DAYS, LAST_14_DAYS, LAST_30_DAYS, LAST_90_DAYS, LAST_365_DAYS, THIS_WEEK_MON_TODAY ,THIS_WEEK_SUN_TODAY, LAST_WEEK, LAST_BUSINESS_WEEK, LAST_WEEK_SUN_SAT, THIS_MONTH, LAST_MONTH, ALL_TIME, CUSTOM_DATE, AUTO)</li>
<li>DateFrom и DateTo - Дата начала и завершения отчётного перода, используется только если в аргумент <em>DateRangeType</em> установлено значение <em>CUSTOM_DATE</em>.</li>
<li>FieldNames - Список полей отчёта.</li>
<li>FilterList - Вектор содержащий условия фильтрации, пример <code>c(&quot;Clicks GREATER_THAN 99&quot;,&quot;Impressions LESS_THAN 1000&quot;)</code>.</li>
<li>IncludeVAT - Учитывать в расчёте трат НДС или нет.</li>
<li>IncludeDiscount - Учитывать в расчёте трат скидку или нет.</li>
<li>Login - Логин клиентского аккаунта.</li>
<li>AgencyAccount - Логин агентского аккаунта, используется только при работе с агентским аккаунтом.</li>
<li>TokenPath - Путь к папке в которую будет созранён файл с учётными данными, либо где уже есть данный файл.</li>
</ul>
<p>Пример загрузки данных из обычного, клиентского аккаунта:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Загрузка статистики</span>
<span class="co"># Работа с обычным рекламным аккаунтом</span>
<span class="co"># Статистика по рекламным кампаниям за пользовательский период с применением фильтра</span>
my_camp_stat &lt;-<span class="st"> </span><span class="kw">yadirGetReport</span>(<span class="dt">ReportType    =</span> <span class="st">&quot;CAMPAIGN_PERFORMANCE_REPORT&quot;</span>,
                               <span class="dt">DateRangeType =</span> <span class="st">&quot;CUSTOM_DATE&quot;</span>,
                               <span class="dt">DateFrom      =</span> <span class="st">&quot;2018-07-01&quot;</span>,
                               <span class="dt">DateTo        =</span> <span class="st">&quot;2018-07-31&quot;</span>,
                               <span class="dt">FieldNames    =</span> <span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>, <span class="st">&quot;CampaignId&quot;</span>, <span class="st">&quot;Clicks&quot;</span>),
                               <span class="dt">FilterList    =</span> <span class="kw">c</span>(<span class="st">&quot;Clicks GREATER_THAN 1&quot;</span>,<span class="st">&quot;Impressions LESS_THAN 1000&quot;</span>),
                               <span class="dt">IncludeVAT    =</span> <span class="st">&quot;YES&quot;</span>,
                               <span class="dt">IncludeDiscount =</span> <span class="st">&quot;NO&quot;</span>,
                               <span class="dt">Login         =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                               <span class="dt">TokenPath     =</span> <span class="st">&quot;direct_tokens&quot;</span>)

<span class="co"># Статистика за прошлую рабочую неделю</span>
my_daily_stat &lt;-<span class="st"> </span><span class="kw">yadirGetReport</span>(<span class="dt">ReportType      =</span> <span class="st">&quot;CUSTOM_REPORT&quot;</span>,
                                <span class="dt">DateRangeType   =</span> <span class="st">&quot;LAST_BUSINESS_WEEK&quot;</span>,
                                <span class="dt">FieldNames      =</span> <span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>, <span class="st">&quot;Clicks&quot;</span>, <span class="st">&quot;Impressions&quot;</span>),
                                <span class="dt">Login           =</span> <span class="st">&quot;netpeak.vyacheslav&quot;</span>,
                                <span class="dt">IncludeVAT      =</span> <span class="st">&quot;YES&quot;</span>,
                                <span class="dt">IncludeDiscount =</span> <span class="st">&quot;NO&quot;</span>,
                                <span class="dt">TokenPath       =</span> <span class="st">&quot;direct_tokens&quot;</span>)</code></pre></div>
<p>Для работы с агентским аккаунтом вам необходимо указать в аргументе <em>AgencyAccount</em> логин агентского аккаунта, в аругмент <em>Login</em> логин клиентского аккаунта из которого вы хотите загрузить данные.</p>
<p>При работе с агентским аккаунтом в аргумент <em>Login</em> можно передавать вектор содержащий логини клиентских аккаунтов, загрузить список клиентов можно с помощью функции <code>yadirGetClientList</code>, загрузить дополнительные параметры клиентов из агентского аккаунта можно с помощью функции <code>yadirGetClientParam</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Работа с агентским рекламным аккаунтом</span>
<span class="co"># загрузка списка клиентов</span>
my_client &lt;-<span class="st"> </span><span class="kw">yadirGetClientList</span>(<span class="dt">AgencyAccount =</span> <span class="st">&quot;netpeak.kz&quot;</span>,
                                <span class="dt">TokenPath     =</span> <span class="st">&quot;direct_tokens&quot;</span>)

<span class="co"># Загрузка данных о стране клиента, валюте аккаунта, оценка показателя качества аккаунтаа</span>
my_cl_param &lt;-<span class="st"> </span><span class="kw">yadirGetClientParam</span>(<span class="dt">AgencyAccount =</span> <span class="st">&quot;netpeak.kz&quot;</span>,
                                   <span class="dt">TokenPath     =</span> <span class="st">&quot;direct_tokens&quot;</span>)

<span class="co"># загрузка статистики по клиентам</span>
my_client_stat &lt;-<span class="st"> </span><span class="kw">yadirGetReport</span>(<span class="dt">ReportType      =</span> <span class="st">&quot;CUSTOM_REPORT&quot;</span>,
                                 <span class="dt">DateRangeType   =</span> <span class="st">&quot;LAST_BUSINESS_WEEK&quot;</span>,
                                 <span class="dt">FieldNames      =</span> <span class="kw">c</span>(<span class="st">&quot;Clicks&quot;</span>, <span class="st">&quot;Impressions&quot;</span>),
                                 <span class="dt">AgencyAccount   =</span> <span class="st">&quot;netpeak.kz&quot;</span>,
                                 <span class="dt">Login           =</span> my_client<span class="op">$</span>Login[<span class="dv">5</span><span class="op">:</span><span class="dv">11</span>],
                                 <span class="dt">IncludeVAT      =</span> <span class="st">&quot;YES&quot;</span>,
                                 <span class="dt">IncludeDiscount =</span> <span class="st">&quot;NO&quot;</span>,
                                 <span class="dt">TokenPath       =</span> <span class="st">&quot;direct_tokens&quot;</span>)</code></pre></div>
</div>
</div>
</div>
<p style="text-align: center;">
<a href="6-2-api-google-ads.html"><button class="btn btn-default">Previous</button></a>
<a href="6-4-api-facebook.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
